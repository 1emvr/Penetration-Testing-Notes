# Vulnerability Assessment

This aims to identify and categorize risks for security weaknesses related to assets within an environment. It's important to note there is little to no manual exploitation during this process. A vulnerability assessment provieds remediation to fix the issues at hand.

The purpose is to understand, identify and categorize the risk for the more apparent issues present in an evnironment without actually exploiting them the gain further access. Depending on the scope of the assessment, some customers may ask us to provide validation on as many vulnerabilities as possible by performing minimally-invasive exploitation to confirm the scanner's findings and rule out false positives.

Other customers will ask for a report of all findings identified by the scanner. As with any assessment, it's essential to clarify the scope and intent of the VA before starting. Vulnerability management is vital to help an organization identify the weak points in their assets, understand the risk leve and calcualate/prioritize remediation efforts. It's also important to note that organizations should always test substantial patches before pushing them out into their environment to prevent disruptions.

## Methodology

8 Steps to Performing a Network Vulnerability Assessment:

> 1. Conduct Risk Identification and Analysis -
>
> Identify all assets that are a part of an information system in a company. With a complete list of all IT equiptment, companies can start assigning risks to each asset in order to account for most situations that may arise.
>
> 2. Develop Vulnerability Scanning Policies -
>
> The policy or procedure should have an official owner that is in responsible for everything that is written inside. The policy should also be approved by upper management before taking effect.
>
> 3. Identify the Type of Scans -
>
> Depending on the software that is running on the system you need to scan and secure, you need to determine the type of scan to be performed in order to get the most benefit. Types of scans include Network, host-based, wireless-based and application scans.
>
> 4. Configure the Scan -
>
> To configure a vulnerability scan you must: add a list of target IPs, define port ranges and protocols, define the targets and set up the aggressiveness of the scan, time and notifications.
>
> 5. Perform the Scan -
>
> The scanning tool will fingerprint the specified targets to gather basic information about them. With this information the tool will proceed to enumerate the targets and gather more detailed specifications such as ports and services that are up and running.
>
> 6. Evaluate and Consider Possible Risks - 
>
> Risks associated with performing a vulnerability scan pertain mostly to the availability of the target system. If the links and connections cannot handle the traffic load generated by the scan, ther remote target can shutdown and become unavailable.
>
> 7. Interpret the Scan Results -
>
> If there is a public exploit available for a vulnerability that you found in your system, giving priority to that vulnerability should take precedence over other vulnerabilities found that are exploitable but with far more effort.
>
> 8. Create a Remediation & Mitigation Plan -
>
> Information security staff should prioritize the mitigation of each vulnerability. The information security staff and IT staff need to communicate and work closely together in the vulnerability mitigation phase in order to streamline the resolution process.
>

## Asset Inventory

Asset inventory is a critical component of vulnerability management. An organizations needs to understand what assets are in it's network to provied the proper protection and sup up appropriate defenses. The asset inventory should include information technology, operational technology, physical assets, software, mobile and development assets.

Organizations can utilize asset management tools to keep track of assets. The assets should have data classifications to ensure adequate security and access controls.

## Applicaiton and System Inventory

An organization should create a thorough and complete inventory of data assets for proper management for defensive security. Data assets include:

- All data stored on-premises. HDDs and SSDs in endpoints (PCs and mobile devices), in servers, external drives in the local network, optical media (DVDs, Blu-ray discs, CDs), flash-media. Legacy technology may include floppy disks, ZIP drives and tape drives as well.

- All of the data storage that their cloud provider possesses. AWS, GCP and Microsoft Azure are some of the most populare cloud providers. but there are many more. Sometimes corporate networks are "multi-cloud", meaining they have more than one cloud provider. A company's cloud provider will provide tools that can be used to inventory all of the data stored.

- All data stored within various `Software-as-a-Service (SaaS)` applications. This data is also "in the cloud" but might not all be within the scope of a corporate cloud provider account. These are often consumer services or the "business" version of those services. Think of online services such as `Google Drive, Dropbox, Microsoft Teams, Apple iCloud, Adobe Creative Suite, MS O365, Google Docs` and so on...

- All of the applications a company needs to user to conduct their usual operation and business. Including applications that are deployed locally and applications that are deployed through the cloud or are otherwise considered SaaS.

- All of a company's on-prem computer networking devices. These include but are not limited to `routers, firewalls, hubs, switches, dedicated IDS/IPS, Data Loss Prevention (DLP) Systems` and so on...

## Compliance Standards

Each regulatory compliance body has it's own information security standards that organizations must adhere to maintain their accreditation. The big complicance players in infosec are `PCI, HIPPA, FISMA` and `ISO 27001`.

These accreditations are necessary because it certifies that an organization has had a third-party vendor evaluate it's environment. Organizations also rely on these accreditations for business operations since some companies won't do business without specific accreditations form organizations.

### Payment Card Industry Data Security Standard (PCI DSS)

The `Payment Card Industry Data Security Standard (PCI DSS)` is a commonly known standard in infosec that implements requirements for organizations that handle credit cards. As per government regulations, organizations that store, process or transmit cardholder data must implement PCI DSS guidelines. This would include banks or online stores that handle their own payment solutions (Amazon).

PCI DSS requirements include internal and external scanning of assets. For example, any credit card data that is being processed or transmitted must be done in a Cardholder Data Environment (CDE). The CDE envirionment must be adequately segmented from normal assets. CDE environments are segmented off from an organization's regular environment to protect any cardholder data from being compromised in the even of an attack:

PCI DSS Goals:

- Build and Maintain a Secure Network
- Protect Cardholder Data
- Maintain a vulnerability Management Program
- Implement Strong Access Control Measures
- Regularly Monitor and Test Networks
- Maintain an Information Security Policy

### Health Insurance Portability and Accountability Act (HIPAA)

HIPPA is the Health Insurance Portability and Accountability Act, which is used to protect patients' data. HIPPA does not necessarily require vulnerability scans or assessments, however, a risk assessment and vulnerability identification are required to maintain HIPPA accreditation.

### Federal Information and Security Management Act (FISMA)

The Federal Information and Security Management Act (FISMA) is a set of standards and guidelines used to safeguard govt. operations and information. The act requires an organization to provide documentation and proof of a vulnerability management program to maintain information technology systems proper confidentiality, integrity and availability (CIA).

### ISO 27001

`ISO 27001` is a standard used worldwide to manage information security. ISO 27001 requires organizations to perform quarterly external and internal scans.

Although compliance is essential, it should not drive a vulnerability management program. Vulnerability management should consider the uniqueness of an environment and the associated risk appetite to an organization.

The `International Organization for Standardization (ISO)` maintains technical standards for pretty much anything you can imagine. The ISO 27001 standard deals with infosec. The ISO 27001 compliance depends upon maintaining an effective Information Security Management System. To ensure compliance, organizations must perform penetration tests in a carefully designed way.

## Penetration Testing Standards

Penetration Tests should not be performed without any rules or guidelines. Ther emust alwasy be a specifically defined scope for a pentest and the owner of a network must have signed a legal contract with the pentesters outlining what they're alowed to do and what they're not allowed to do.

Pentesting should also be conducted in such a way that minimal harm is done to a company's computers and networks. penetration testers should avoid making changes wherever possible (such as changing an account password) and limit the amount of data removed from a client's network.

For example, instead of removing sensitive documents from a file share, a screenshot of the folder names should suffice to prove the risk. In addition to the scope and legalities, there are also various pentesting standards, depending on what kind of computer system is being assessed. Here are some of the more common standards you may use a penetration tester:

### PTES

The `Penetration Testing Execution Standard (PTES)` can be applied to all types of tests. It outlines the phases of a penetration test and how they should be conducted. These are the sections in the `PTES`:

- Pre-engagement Interactions
- Intelligence Gathering
- Threat Modeling
- Vulnerability Analysis
- Exploitation
- Post-Exploitation
- Reporting

### OSSTMM

`OSSTMM` is the `Open Source Security Testing Methodology Manual`, another set of guidelines pentesters can use to ensure they're doing their jobs properly. It can be used alongside other pentest standards.

OSSTMM is divided into five different channels for five different areas of pentesting:

- Human Security (social engineering exploits)
- Physical Security
- Wireless Communications (including but not limited to WiFi and Bluetooth)
- Telecommunications
- Data Networks

### NIST

The `NIST (National Institute of Standards and Technology)` is well known for their `NIST Cybersecurity Framework`, a system for designing incident response policies and procedures. NIST also has a `Penetration Testing Framework`. The phases of the NIST framework include:

- Planning
- Discovery
- Attack
- Reporting

### OWASP

`OWASP` stands for `Open Web Application Security Project`. They're typically the go-to organization for defining testing standareds and classifying risks involving web applications.

OWASP maintains a few different standards and helpful guides for assessment of various technologies:

- Web Security Testing Guide (WSTG)
- Mobile Security Testing Guide (MSTG)
- Firmware Security Testing Methodology

```
Note: The VM provided at the Nessus Skills Assessment section has Nessus pre-installed and the targets running. You can go to that section and start the VM and use Nessus throughout the module, which can be accessed at https:// < IP >:8834. The Nessus credentials are: htb-student:HTB_@cademy_student!. You may also use these credentials to SSH into the target VM to configure Nessus.

htb-student:HTB_@cademy_student!
 and administrator:Academy_VA_adm1! for Windows


 *Requirements

Navigate to the web interface at the end of this section and log in with the provided credentials.

Once logged in, perform a BASIC NETWORK SCAN (modify the scan template to scan ALL ports, leave all other options the same) against the target: 172.16.16.100. Additionally, set up the scan to be authenticated using administrator:Academy_VA_adm1! as the credentials.

The scan will take up to 60 minutes to finish.

Note: It may take 1-2 minutes for your target instance to spawn. Additionally, it may take up to an hour for the scan to run

Alternatively, use the pre-populated scan data to answer the questions below without having to wait for the scan to finish but feel free to practice configuring and running it.
```

